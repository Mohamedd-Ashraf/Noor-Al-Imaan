# ๐ ุงูุญู ุงููุซุงูู ููุธุงู ุชุญุฏูุซ ุงูุชุทุจูู
## Premium App Update System with Firebase & In-App Updates

---

## ๐ ููุงุฐุง ูุฐุง ุงูุญู ูู ุงูุฃูุซูุ

### โ **ุงููููุฒุงุช ุงูุงุญุชุฑุงููุฉ:**

1. **๐ฅ Firebase Remote Config**
   - ุชุญุฏูุซ ุงูุฅุนุฏุงุฏุงุช ุจุฏูู ุงูุญุงุฌุฉ ูุฎุงุฏู ุฎุงุต
   - ุชุบููุฑ ูุนูููุงุช ุงูุชุญุฏูุซ ูู ุงูููุช ุงููุนูู
   - ูุฌุงูู ุชูุงูุงู (ุญุชู 50,000 ูุณุชุฎุฏู ูุดุท ููููุงู)
   - ุขูู ูููุซูู ูู Google

2. **๐ฑ In-App Updates ููุฃูุฏุฑููุฏ**
   - ุชุญุฏูุซ ูุจุงุดุฑ ูู ุฏุงุฎู ุงูุชุทุจูู (ุจุฏูู ูุชุญ Play Store)
   - ููุนุงู ูู ุงูุชุญุฏูุซุงุช:
     - **Flexible**: ุงููุณุชุฎุฏู ูุณุชูุฑ ูู ุงุณุชุฎุฏุงู ุงูุชุทุจูู ุฃุซูุงุก ุงูุชุญููู
     - **Immediate**: ููุชุญุฏูุซุงุช ุงูุฅูุฒุงููุฉ - ูููุฑุถ ุงูุชุญุฏูุซ ููุฑุงู

3. **๐ ุฏุนู iOS**
   - ุชูุฌูู ุชููุงุฆู ุฅูู App Store
   - ูุงุฌูุฉ ููุญุฏุฉ ูุฌููุน ุงูููุตุงุช

4. **๐จ ูุงุฌูุฉ ูุญุณููุฉ**
   - ุชุตููู ุนุตุฑู ูุฌุฐุงุจ
   - ุฏุนู ูุงูู ููุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
   - ูุคุดุฑุงุช ุชูุฏู ูุงุถุญุฉ

5. **๐ ุงูุฃูุงู**
   - Firebase ูุคูู ุจุดูู ูุงูู
   - ูุง ุญุงุฌุฉ ูุงุณุชุถุงูุฉ ุฎุงุฑุฌูุฉ ูุฏ ุชููู ุบูุฑ ุขููุฉ
   - ุชุญูู ุชููุงุฆู ูู ุตุญุฉ ุงูุจูุงูุงุช

---

## ๐ ุงูููุงุฑูุฉ ุจูู ุงูุญููู

| ุงูููุฒุฉ | ุงูุญู ุงูุจุณูุท (JSON) | ุงูุญู ุงููุซุงูู (Firebase) |
|--------|-------------------|------------------------|
| ุงุณุชุถุงูุฉ ุฎุงุฑุฌูุฉ | โ ูุทููุจุฉ | โ ุบูุฑ ูุทููุจุฉ |
| ุงูุชูููุฉ | ูุฏ ุชููู ูุฏููุนุฉ | ูุฌุงูู ููุฃุจุฏ |
| ุงูุชุญุฏูุซุงุช ุงูููุฑูุฉ | โ ูุญุชุงุฌ ุชุญุฏูุซ ุงูููู | โ ูู ููุญุฉ Firebase |
| In-App Update | โ | โ |
| ุณูููุฉ ุงูุฅุฏุงุฑุฉ | ูุชูุณุทุฉ | ุนุงููุฉ ุฌุฏุงู |
| ุงูุฃูุงู | ูุชูุณุท | ุนุงูู ุฌุฏุงู |
| ุงููุฑููุฉ | ูุญุฏูุฏุฉ | ุบูุฑ ูุญุฏูุฏุฉ |

---

## ๐๏ธ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ

### 1๏ธโฃ ุฅุถุงูุฉ Firebase ูููุดุฑูุน

#### ุฃ) ุฅูุดุงุก ูุดุฑูุน Firebase:
1. ุงูุชุญ [Firebase Console](https://console.firebase.google.com/)
2. ุงุถุบุท **Add Project** (ุฅุถุงูุฉ ูุดุฑูุน)
3. ุฃุฏุฎู ุงุณู ุงููุดุฑูุน: `Quraan App`
4. ูุนูู Google Analytics (ุงุฎุชูุงุฑู)
5. ุงุถุบุท **Create Project**

#### ุจ) ุฅุถุงูุฉ Android App:
1. ูู ููุญุฉ Firebaseุ ุงุถุบุท ุนูู ุฃููููุฉ Android
2. ุฃุฏุฎู Package Name: `com.yourcompany.quraan`
   - ุงุญุตู ุนููู ูู: `android/app/build.gradle.kts` โ `applicationId`
3. ุญููู ููู `google-services.json`
4. ุถุนู ูู: `android/app/google-services.json`

#### ุฌ) ุฅุถุงูุฉ iOS App (ุงุฎุชูุงุฑู):
1. ูู ููุญุฉ Firebaseุ ุงุถุบุท ุนูู ุฃููููุฉ iOS
2. ุฃุฏุฎู Bundle ID ูู: `ios/Runner.xcodeproj/project.pbxproj`
3. ุญููู ููู `GoogleService-Info.plist`
4. ุถุนู ูู: `ios/Runner/GoogleService-Info.plist`

---

### 2๏ธโฃ ุชูููู Android ููู Firebase

ุงูุชุญ **`android/build.gradle.kts`** ูุฃุถู:

```kotlin
buildscript {
    dependencies {
        // ... existing dependencies
        classpath("com.google.gms:google-services:4.4.0")
    }
}
```

ุงูุชุญ **`android/app/build.gradle.kts`** ูุฃุถู ูู ุงูููุงูุฉ:

```kotlin
plugins {
    id("com.android.application")
    id("kotlin-android")
    id("dev.flutter.flutter-gradle-plugin")
    id("com.google.gms.google-services") // Add this line
}
```

---

### 3๏ธโฃ ุฅุนุฏุงุฏ Firebase Remote Config

#### ูู Firebase Console:

1. ุงุฐูุจ ุฅูู **Remote Config** ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
2. ุงุถุบุท **Add parameter** ููู ููุชุงุญ:

| Key | Type | Default Value | Description |
|-----|------|---------------|-------------|
| `latest_version` | String | `1.0.0` | ุขุฎุฑ ุฅุตุฏุงุฑ ูุชุงุญ |
| `minimum_version` | String | `1.0.0` | ุงูุญุฏ ุงูุฃุฏูู ุงููุทููุจ |
| `is_mandatory` | Boolean | `false` | ูู ุงูุชุญุฏูุซ ุฅูุฒุงููุ |
| `download_url` | String | `https://play.google.com/store/apps/details?id=com.yourcompany.quraan` | ุฑุงุจุท ุงูุชุญููู |
| `changelog_ar` | String | `ุชุญุณููุงุช ุนุงูุฉ` | ุงูุชุบููุฑุงุช ุจุงูุนุฑุจูุฉ |
| `changelog_en` | String | `General improvements` | ุงูุชุบููุฑุงุช ุจุงูุฅูุฌููุฒูุฉ |
| `release_date` | String | `2026-02-18T00:00:00.000Z` | ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑ |
| `enable_in_app_update` | Boolean | `true` | ุชูุนูู In-App Update |

3. ุงุถุบุท **Publish changes**

---

### 4๏ธโฃ ุชุซุจูุช Dependencies

```bash
flutter pub get
```

---

### 5๏ธโฃ ุงุณุชุจุฏุงู main.dart

ุงุณุชุจุฏู **`lib/main.dart`** ุจู **`lib/main_firebase.dart`** (ุฃู ุงุณุชูุฑุฏ ููู):

```bash
# ุทุฑููุฉ 1: ูุณุฎุฉ ุงุญุชูุงุทูุฉ
mv lib/main.dart lib/main_simple.dart
mv lib/main_firebase.dart lib/main.dart

# ุทุฑููุฉ 2: ุชุนุฏูู main.dart ูุงุณุชูุฑุงุฏ Firebase version
```

ุฃู ุจุจุณุงุทุฉ ุนุฏูู **`lib/main.dart`** ููุทุงุจู **`lib/main_firebase.dart`**

---

### 6๏ธโฃ ุงุณุชุจุฏุงู injection_container.dart

ุงุณุชุจุฏู **`lib/core/di/injection_container.dart`** ุจู **`lib/core/di/injection_container_firebase.dart`**

```bash
mv lib/core/di/injection_container.dart lib/core/di/injection_container_simple.dart
mv lib/core/di/injection_container_firebase.dart lib/core/di/injection_container.dart
```

---

## ๐ฎ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ๐ ุชุญุฏูุซ ุงูุชุทุจูู (ููุทูุฑ)

ุนูุฏูุง ุชุฑูุฏ ูุดุฑ ุชุญุฏูุซ ุฌุฏูุฏ:

1. **ุงุฑูุน ุงูุชุทุจูู ุฅูู Play Store / App Store**
   ```bash
   flutter build appbundle --release  # ููุฃูุฏุฑููุฏ
   flutter build ipa --release        # ููู iOS
   ```

2. **ุญุฏูุซ Firebase Remote Config:**
   - ุงูุชุญ [Firebase Console](https://console.firebase.google.com/)
   - ุงุฐูุจ ุฅูู **Remote Config**
   - ุนุฏูู ุงูููู:
     - `latest_version`: `1.1.0` (ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ)
     - `changelog_ar`: ูุงุฆูุฉ ุงูุชุบููุฑุงุช ุจุงูุนุฑุจูุฉ
     - `changelog_en`: ูุงุฆูุฉ ุงูุชุบููุฑุงุช ุจุงูุฅูุฌููุฒูุฉ
     - `is_mandatory`: `true` (ุฅุฐุง ูุงู ุฅูุฒุงููุงู)
     - `minimum_version`: `1.1.0` (ุฅุฐุง ูุงู ุฅูุฒุงููุงู ุนูู ุงูุฌููุน)
   - ุงุถุบุท **Publish changes**

3. **ุงูุชุธุฑ!** ๐
   - ุงููุณุชุฎุฏููู ุณูุญุตููู ุนูู ุฅุดุนุงุฑ ุงูุชุญุฏูุซ ุชููุงุฆูุงู
   - ูุง ุญุงุฌุฉ ูุฃู ุดูุก ุขุฎุฑ!

---

### ๐ ุฃููุงุน ุงูุชุญุฏูุซุงุช

#### 1. ุชุญุฏูุซ ุงุฎุชูุงุฑู (Optional Update)
```
latest_version: 1.1.0
minimum_version: 1.0.0
is_mandatory: false
```
- ุงููุณุชุฎุฏู ููููู ุชุฌุงูู ุงูุชุญุฏูุซ
- ูุธูุฑ ุฒุฑ "ูุงุญูุงู"
- **Android**: ุชุญุฏูุซ ูุฑู (Flexible)

#### 2. ุชุญุฏูุซ ุฅูุฒุงูู (Mandatory Update)
```
latest_version: 2.0.0
minimum_version: 2.0.0
is_mandatory: true
```
- ุงููุณุชุฎุฏู **ูุฌุจ** ุฃู ูุญุฏูุซ
- ูุง ูููู ุฅุบูุงู ุงููุงูุฐุฉ
- **Android**: ุชุญุฏูุซ ููุฑู (Immediate)

#### 3. ุฅุฌุจุงุฑ ุฅุตุฏุงุฑุงุช ูุฏููุฉ ููุท
```
latest_version: 2.5.0
minimum_version: 2.0.0
is_mandatory: false
```
- ูู ุนูุฏู ุฃูู ูู 2.0.0 โ **ุฅูุฒุงูู**
- ูู ุนูุฏู 2.0.0+ โ ุงุฎุชูุงุฑู

---

### ๐ก ุฅุถุงูุฉ ุฒุฑ "ูุญุต ุงูุชุญุฏูุซุงุช" ูู ุงูุฅุนุฏุงุฏุงุช

ูู ุดุงุดุฉ ุงูุฅุนุฏุงุฏุงุชุ ุฃุถู:

```dart
import 'package:quraan/core/widgets/update_settings_tile.dart';

// ูู ListView ุงูุฎุงุต ุจุงูุฅุนุฏุงุฏุงุช:
UpdateSettingsTile(languageCode: 'ar'),
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ Firebase Remote Config:

1. **ุบููุฑ ุงูุฅุตุฏุงุฑ ูู Remote Config:**
   - ุงุฌุนู `latest_version` = `2.0.0`
   - `is_mandatory` = `false`

2. **ุดุบูู ุงูุชุทุจูู:**
   ```bash
   flutter run
   ```

3. **ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ ุงูุชุญุฏูุซ!** ๐

### ุงุฎุชุจุงุฑ In-App Update (Android ููุท):

1. **ุงุฑูุน ูุณุฎุฉ ูุฏููุฉ ุนูู Play Console (Internal Testing)**
2. **ุซุจูุช ุงููุณุฎุฉ ุนูู ุฌูุงุฒู**
3. **ุงุฑูุน ูุณุฎุฉ ุฌุฏูุฏุฉ ุนูู Play Console**
4. **ุงูุชุธุฑ ุจุถุน ุณุงุนุงุช**
5. **ุงูุชุญ ุงูุชุทุจูู** - ูุฌุจ ุฃู ูุธูุฑ In-App Update!

---

## ๐จ ุงูุชุฎุตูุต

### ุชุบููุฑ ุฃููุงู Dialog:

ูู **`lib/core/widgets/app_update_dialog_premium.dart`**:

```dart
// ุงูุฃููุงู ุงูุฃุณุงุณูุฉ
color: Colors.blue.shade700  // โ ุบููุฑูุง ูู Colors.green
```

### ุชุบููุฑ ูุชูุฑุฉ ุงููุญุต:

ูู **`lib/main_firebase.dart`**:

```dart
final shouldCheck = await updateService.shouldCheckForUpdate(
  minInterval: Duration(hours: 6), // ูู 6 ุณุงุนุงุช ุจุฏูุงู ูู 12
);
```

---

## ๐ ุงูุฃูุงู ูุงูุฎุตูุตูุฉ

### ุชุฃููู Firebase:

1. **Firebase Rules** (ุงุฎุชูุงุฑู):
   ```json
   {
     "rules": {
       ".read": "auth != null",
       ".write": false
     }
   }
   ```

2. **ุชูููุฏ API Key:**
   - ูู Google Cloud Console
   - ูููุฏ API key ููุฃูุฏุฑููุฏ ููุท ุจู package name

---

## ๐ ุงูุชุญูููุงุช ูุงูุฅุญุตุงุฆูุงุช

### ุชุชุจุน ูู ูุงู ุจุงูุชุญุฏูุซ:

ุฃุถู ูู **`lib/core/services/app_update_service_firebase.dart`**:

```dart
import 'package:firebase_analytics/firebase_analytics.dart';

// ุจุนุฏ ุชุซุจูุช ุงูุชุญุฏูุซ
FirebaseAnalytics.instance.logEvent(
  name: 'app_update_completed',
  parameters: {
    'from_version': currentVersion,
    'to_version': latestVersion,
    'update_type': isMandatory ? 'mandatory' : 'optional',
  },
);
```

---

## โ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: Firebase ูุง ูุนูู

**ุงูุญู:**
```bash
# ุชุฃูุฏ ูู ุฅุถุงูุฉ google-services.json
ls android/app/google-services.json

# ุชุฃูุฏ ูู Plugin ูู build.gradle
cat android/app/build.gradle.kts | grep google-services
```

### ุงููุดููุฉ: In-App Update ูุง ูุธูุฑ

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
1. ุงูุชุทุจูู ููุณ ูู Play Store (ูุนูู ููุท ูุน ุชุซุจูุช ูู Store)
2. ูู ููุฑ ููุช ูุงูู ุจุนุฏ ุฑูุน ุงููุณุฎุฉ ุงูุฌุฏูุฏุฉ (ุงูุชุธุฑ ุณุงุนุฉ)
3. `enable_in_app_update` = `false` ูู Remote Config

**ุงูุญู:**
- ุงุฎุชุจุฑ ูุน **Internal Testing Track** ุนูู Play Console
- ุงูุชุธุฑ ุจุถุน ุณุงุนุงุช ุจุนุฏ ุฑูุน ุงููุณุฎุฉ

### ุงููุดููุฉ: ุงูุชุญุฏูุซ ูุธูุฑ ุจุงุณุชูุฑุงุฑ

**ุงูุญู:**
```dart
// ุชุฃูุฏ ูู ุชุญุฏูุซ version ูู pubspec.yaml
version: 1.1.0+2  // ุบููุฑ ููุง
```

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

โ **ุชู ุฅูุฌุงุฒู:**
- ูุธุงู ุชุญุฏูุซุงุช ุงุญุชุฑุงูู ุจู Firebase
- In-App Updates ููุฃูุฏุฑููุฏ
- ูุงุฌูุฉ ุนุตุฑูุฉ
- ุฏุนู ูุงูู ููุนุฑุจูุฉ

๐ **ููุชุญุณูู ูุณุชูุจูุงู:**
- ุฅุถุงูุฉ Firebase Analytics ูุชุชุจุน ุงูุชุญุฏูุซุงุช
- ุฅุดุนุงุฑุงุช Push ููุชุญุฏูุซุงุช ุงููููุฉ
- A/B Testing ูุฑุณุงุฆู ุงูุชุญุฏูุซ ุงููุฎุชููุฉ
- ุชุญุฏูุซุงุช ุชููุงุฆูุฉ ูู ุงูุฎูููุฉ

---

## ๐ ูุตุงุฏุฑ ุฅุถุงููุฉ

- [Firebase Remote Config Docs](https://firebase.google.com/docs/remote-config)
- [In-App Updates Guide](https://developer.android.com/guide/playcore/in-app-updates)
- [Flutter Firebase Setup](https://firebase.google.com/docs/flutter/setup)

---

## ๐ฏ ุงูุฎูุงุตุฉ

ูุฐุง ูู **ุงูุญู ุงููุซุงูู** ููุธุงู ุงูุชุญุฏูุซุงุช ูุฃูู:

1. โ **ูุฌุงูู ุชูุงูุงู** - Firebase ูุฌุงูู ุญุชู 50K ูุณุชุฎุฏู ูุดุท
2. โ **ุณูู ุงูุฅุฏุงุฑุฉ** - ุชุบููุฑ ุงูุฅุนุฏุงุฏุงุช ูู Firebase Console ููุท
3. โ **ุงุญุชุฑุงูู** - In-App Updates ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ
4. โ **ุขูู** - Firebase ูู Googleุ ููุซูู ุชูุงูุงู
5. โ **ูุฑู** - ุณูุทุฑุฉ ูุงููุฉ ุนูู ูู ุฅุตุฏุงุฑ

---

**ุจุงูุชูููู! ๐**

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉุ ุฑุงุฌุน ูุณู "ุงุณุชูุดุงู ุงูุฃุฎุทุงุก" ุฃู ุงูุชุญ issue ุนูู GitHub.
